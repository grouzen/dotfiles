;;; -*- lisp -*-
(in-package :stumpwm)

;; common font
(set-font "-*-snap-*-*-*-*-10-*-*-*-*-*-iso10646-1")
;(set-font "-misc-dejavu sans condensed-medium-r-semicondensed--0-0-0-0-p-0-iso10646-1")

;; modules
(load "/home/grouzen/desktop/src/sources/build/stumpwm-0.9.5-1/contrib/cpu.lisp")
(load "/home/grouzen/desktop/src/sources/build/stumpwm-0.9.5-1/contrib/mem.lisp")
(load "/home/grouzen/desktop/src/sources/build/stumpwm-0.9.5-1/contrib/net.lisp")
;(load "/home/grouzen/desktop/src/sources/build/stumpwm-0.9.5-1/contrib/battery.lisp")
;(load "/home/grouzen/desktop/src/sources/build/stumpwm-0.9.5-1/contrib/battery-portable.lisp")
(load "/home/grouzen/desktop/src/sources/build/stumpwm-0.9.5-1/contrib/disk.lisp")

;; mode-line colors
(setf *mode-line-background-color* "black")
(setf *mode-line-foreground-color* "orange")
(setf *mode-line-border-color* "orange")
(setf *mode-line-timeout* 1)

(setf *screen-mode-line-format*
	  (list "[ "
			'(:eval (run-shell-command
						  "date '+%a %d %b %H:%M:%S' | tr -d [:cntrl:]"
						  t))
			" ] "
			"[ %n ] "
			;"[%b] " ;; bat
			"[%c] " ;; cpu
			"[%M] " ;; mem
			;"[%D] " ;; disk
			"[%l] " ;; net
			"%W"))

;(defun update-mode-line ()
;  "Update mode line"
;  (let ((screen (current-screen)))
;	(when (screen-mode-line screen)
;	  (redraw-mode-line-for (screen-mode-line screen) screen))))

;#+sbcl (sb-ext:shedule-timer
;		*mode-line-timer* (sb-ext:make-timer
;						   #'update-mode-line
;						   :name "mode-line-updating"
;						   :thread (car (last (sb-thread:list-all-threads)))))

;#+sbcl (sb-ext:shedule-timer *mode-line-timer* 5 :repeat-interval 10 :absolue-p nil)

(run-commands "mode-line")

;; input and message panels
(set-bg-color "black")
(set-fg-color "orange")
(set-border-color "orange")
(setf *message-window-gravity* :bottom-right)
(setf *input-window-gravity* :bottom-right)
(set-normal-gravity :center)
(set-win-bg-color "white")

(set-focus-color "orange")
(set-unfocus-color "blue")

(setf *frame-number-map* "1234567890")
(setf (group-name (first (screen-groups (current-screen)))) "1")

;; keys
(define-key *root-map* (kbd "C-c") "exec urxvt")
(define-key *root-map* (kbd "c") "exec urxvt")
